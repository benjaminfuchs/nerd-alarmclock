#!/usr/bin/python3
# --------------------------------------------------------------------------
# Class definition of Button
#
# Author: Benjamin Fuchs
# License: GPL3
#
# Website: https://github.com/benjaminfuchs/who_disposer
#
# --------------------------------------------------------------------------

import RPi.GPIO as GPIO


class Button():
    """ Button class """

    def __init__(self, pin):
        """ Constructor """
        self._pin = pin
        self._status = False
        self._listeners = []
        GPIO.setmode(GPIO.BCM)
        GPIO.setup(self._pin, GPIO.IN, pull_up_down=GPIO.PUD_UP)
        GPIO.add_event_detect(self._pin, GPIO.BOTH, callback=self._on_event)

    def add_listener(self, function):
        self._listeners.append(function)

    def _on_event(self, pin):
        """ set status of button """
        self._status ^= bool(GPIO.input(pin))
        for listener in self._listeners:
            listener(self._status)
